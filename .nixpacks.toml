[phases.setup]
nixPkgs = [
  "python312",
  "chromium",
  "nss",
  "freetype",
  "harfbuzz",
  "ca-certificates",
  "fontconfig",
  "libjpeg_turbo",
  "zlib",
  "libpng",
  "libtiff",
  "libwebp",
  "openjpeg"
]

[phases.install]
cmds = [
  "pip install --upgrade pip",
  "pip install -r requirements.txt",
  # âœ… Only install Chromium browser and dependencies
  "playwright install chromium --with-deps"
]

[phases.build]
cmds = [
  "mkdir -p logs temp",
  "chmod 755 logs temp"
]

[start]
cmd = "python app.py"

[variables]
PYTHONUNBUFFERED = "1"
PLAYWRIGHT_BROWSERS_PATH = "/root/.cache/ms-playwright"
PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD = "0"
